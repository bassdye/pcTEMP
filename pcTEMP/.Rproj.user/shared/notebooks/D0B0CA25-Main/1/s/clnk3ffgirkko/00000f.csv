"0","tmp_dat <- combined_dat %>%"
"0","  add_column(experiment = c(row.names.data.frame(non_grad_dat), row.names.data.frame(acute_dat), row.names.data.frame(final_dat)),"
"0","             phase = c(rep(""I"", time = length(non_gradient_separate)), rep(""II"", time = length(acute_separate)), rep(""III"", time = length(final_separate))),"
"0","             .before = colnames(non_grad_dat[1])) "
"0",""
"0","if(exists(""number_treatments"")) {"
"0","  tmp_dat <- tmp_dat %>% "
"0","    add_column(treatment = rep(treatments, times = nrow(non_grad_dat) / number_treatments * number_phases), .after = ""phase"") # Add treatments column; times = # experiments / # treatments * 3 phases"
"0","  rownames(tmp_dat) <- NULL # Remove row names"
"0","  colnames(tmp_dat)[c(4:11)] <- c(""z1"", ""z2"", ""z3"", ""z4"", ""z5"", ""z6"", ""z7"", ""z8"")"
"0","} else {"
"0","  rownames(tmp_dat) <- NULL # Remove row names"
"0","  colnames(tmp_dat)[c(3:10)] <- c(""z1"", ""z2"", ""z3"", ""z4"", ""z5"", ""z6"", ""z7"", ""z8"")"
"0","}"
"0","  "
"0","# Calculate percent use of each compartment per experiment"
"0","if(exists(""number_treatments"")) {"
"0","  stats_df <- data.frame(tmp_dat[, 1:11])"
"0","  stats_df[, 4:11] <- NA"
"0","  for (ii in 1:nrow(combined_dat)) {"
"0","    for (tt in 4:11)"
"0","      stats_df[ii,tt] <- unlist(tmp_dat[ii, tt]) / tmp_dat$count[ii]"
"0","  }"
"0","} else {"
"0","  stats_df <- data.frame(tmp_dat[, 1:10])"
"0","  stats_df[, 3:10] <- NA"
"0","  for (ii in 1:nrow(combined_dat)) {"
"0","    for (tt in 3:10)"
"0","      stats_df[ii,tt] <- unlist(tmp_dat[ii, tt]) / tmp_dat$count[ii]"
"0","  }"
"0","}"
"0",""
"0","# Clear space in environment"
"0","rm(list = c(""non_grad_dat"", ""acute_dat"", ""final_dat"", ""combined_dat"", ""tmp_dat""))"
